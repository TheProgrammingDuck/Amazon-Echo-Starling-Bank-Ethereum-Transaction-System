{"version":3,"names":[],"mappings":"","sources":["entities/transaction.js"],"sourcesContent":["import axios from 'axios';\nimport debug from 'debug';\nimport {defaultHeaders} from '../utils/http';\nimport {typeValidation} from '../utils/validator';\n\nconst log = debug('starling:transaction-service');\n\nconst transactionSource = (source) => {\n  if (source === 'MASTER_CARD') {\n    return '/mastercard';\n  } else if (source === 'FASTER_PAYMENTS_IN') {\n    return '/fps/in';\n  } else if (source === 'FASTER_PAYMENTS_OUT') {\n    return '/fps/out';\n  } else if (source === 'DIRECT_DEBIT') {\n    return '/direct-debit';\n  } else {\n    return ''\n  }\n};\n\n/**\n * Service to interact with a customer's transactions\n */\nclass Transaction {\n  /**\n   * Create a new transaction service\n   * @param {Object} options - configuration parameters\n   */\n  constructor (options) {\n    this.options = options;\n  }\n\n  /**\n   * Gets the customer's transactions over the given period\n   * @param {string} accessToken - the oauth bearer token.\n   * @param {string} fromDate - filter transactions after this date. Format: YYYY-MM-DD\n   * @param {string} toDate - filter transactions before this date. Format: YYYY-MM-DD\n   * @param {string=} source - the transaction type (e.g. faster payments, mastercard).\n   * If not specified, results are not filtered by source.\n   * @return {Promise} - the http request promise\n   */\n  getTransactions (accessToken, fromDate, toDate, source) {\n    typeValidation(arguments, getTransactionsParameterDefinition);\n    const url = `${this.options.apiUrl}/api/v1/transactions${transactionSource(source)}`;\n    log(`GET ${url} from=${fromDate} to=${toDate}`);\n\n    return axios({\n      method: 'GET',\n      url,\n      params: {\n        from: fromDate,\n        to: toDate\n      },\n      headers: defaultHeaders(accessToken)\n    });\n  }\n\n  /**\n   * Gets the full details of a single transaction\n   * @param {string} accessToken - the oauth bearer token\n   * @param {string} transactionId - the unique transaction ID\n   * @param {string=} source - the transaction type (e.g. faster payments, mastercard).\n   * If not specified, only generic transaction information will be returned.\n   * @return {Promise} - the http request promise\n   */\n  getTransaction (accessToken, transactionId, source) {\n    typeValidation(arguments, getTransactionParameterDefinition);\n    const url = `${this.options.apiUrl}/api/v1/transactions${transactionSource(source)}/${transactionId}`;\n    log(`GET ${url}`);\n    return axios({\n      method: 'GET',\n      url,\n      headers: defaultHeaders(accessToken)\n    });\n  }\n}\n\nconst getTransactionsParameterDefinition = [\n  {name: 'accessToken', validations: ['required', 'string']},\n  {name: 'fromDate', validations: ['optional', 'string']},\n  {name: 'toDate', validations: ['optional', 'string']},\n  {name: 'source', validations: ['optional', 'string']}\n];\n\nconst getTransactionParameterDefinition = [\n  {name: 'accessToken', validations: ['required', 'string']},\n  {name: 'transactionId', validations: ['required', 'string']},\n  {name: 'source', validations: ['optional', 'string']}\n];\n\nmodule.exports = Transaction;\n"],"file":"transaction.js"}